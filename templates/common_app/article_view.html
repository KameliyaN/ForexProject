{% extends 'common_app/base.html' %}
{% load static %}
{% load crispy_forms_filters %}
{% block body_block %}

    <link rel="stylesheet" href="{% static 'accounts/css/circle_pic.css' %}"/>
    <link rel="stylesheet" href="{% static 'accounts/css/small_pic.css' %}"/>

    <div class="jumbotron text-center hoverable p-4">


        <div class="row">


            <div class="col-md-4 offset-md-1 mx-3 my-3">


                <div class="view overlay">
                    {% if  article.user.picture %}
                        <img id="circle_pic" src="{{ article.user.picture.url }}" alt="">
                    {% else %}
                        <img id="small_pic" src="{% static 'accounts/images/default_user.png' %}" alt="">
                    {% endif %}


                </div>

            </div>

            <div class="col-md-7 text-md-left ml-3 mt-3">


                <a href="{% url 'all user articles' article.user.pk %}" class="green-text">
                    <h6 class="h6 pb-1"><i class="fas fa-desktop pr-1"></i> More author`s articles</h6>
                </a>

                <h4 class="h4 mb-4">{{ article.title }}</h4>

                <p class="font-weight-normal">{{ article.content }}</p>
                <p class="font-weight-normal">by
                    <a><strong>{{ article.user.first_name }} {{ article.user.last_name }}</strong></a>, {{ article.date }}
                </p>


                <a class="btn btn-success" href="{% url 'edit article' article.pk %}">Edit article</a>
                <a class="btn btn-danger" href="{% url 'delete article' article.pk %}">Delete article</a>


            </div>


        </div>


    </div>
    <div class="jumbotron ">
        <h5><em>Article comments:</em></h5>
        <br>

        {% if article.comment_set.all %}
            {% for comment in  article.comment_set.all %}
                <div class="card mb-3" style="max-width: 540px;">
                    <div class="row no-gutters">
                        <div class="col-md-4">
                            {% if  comment.user.picture %}
                                <img id="small_pic" class="card-img" src="{{ comment.user.picture.url }}" alt="">
                            {% else %}
                                <img id="small_pic" class="card-img"
                                     src="{% static 'accounts/images/default_user.png' %}" alt="">
                            {% endif %}

                        </div>
                        <div class="col-md-8">
                            <div class="card-body">
                                <h5 class="card-title">{{ comment.user.username }}</h5>
                                <p class="card-text">{{ comment.text }}</p>
                                <p class="card-text"><small class="text-muted">Last updated {{ comment.date }}</small>
                                </p>

                                {% if request.user.username == comment.user.username or request.user.is_superuser %}


                                    <a class="inline-related" style="color: green"
                                       href="{% url 'edit article' article.pk %}">Edit </a>
                                    <a class="inline-related" style="color: red"
                                       href="{% url 'delete article' article.pk %}">Delete </a>
                                {% endif %}

                            </div>

                        </div>

                    </div>


                </div>
                <br>


            {% endfor %}

        {% else %}
            <p>Be the first and share your opinion with us!</p>
        {% endif %}
        <a class="btn btn-secondary" href="{% url 'create comment' article.pk %}">Comment</a>
    </div>
{% endblock %}